---
description: CollabBoard project rules and PRD patterns
alwaysApply: true
---

# CollabBoard Project Rules

Building CollabBoard per PRD v6.0 (Supabase stack). Current state: Vite + React + TS;
Fabric.js canvas. Priority: MVP gate — auth → infinite canvas/pan/zoom →
basic object create/move → delta sync via Supabase Postgres + Realtime → cursors/presence.

## Stack (PRD v6.0)
- **Frontend:** React + Fabric.js (BSD license). Visual style: clean/flat (tldraw-like).
- **Sync:** Supabase PostgreSQL + Realtime — delta-only, object-level patches
- **Auth:** Supabase Auth (Google + Email)
- **Server:** Supabase Edge Functions (invite, AI post-MVP)
- **Deploy:** Vercel + Supabase

## Critical Constraints
- **Sync:** Never write full board state. Use object-level deltas only. Supabase upsert/insert. Server timestamps.
- **Viewport culling:** Only render objects in view (500+ object target).
- **Locking:** Dual-layer (client disable + server RLS). User A cannot edit what User B is editing.
- **IDs:** Client-side UUID v4 (`crypto.randomUUID()`).

## Code Standards
- Single Responsibility Principle
- File size: target <400 LOC, hard max 1000 LOC
- Feature-sliced folder structure
- No cross-feature imports except via interfaces
- Jest + React Testing Library; ESLint + Prettier + Husky
